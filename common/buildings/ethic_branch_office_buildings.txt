###########################
# Branch Office Buildings #
###########################

## N.B.: ai_weight is still used for branch offices!

@traders_from_civic = 200
@crime_floor_from_legal_crime = 5
@trade_value_from_jobs = 0.01


# Underground Railroad
building_underground_railroad_office = {
	base_buildtime = @b2_time
	planet_limit = 1

	owner_type = corporate

	category = government
	
	#allow = {		#Steam: Tagged this whole thing because the indented tags were already present and it just kinda broke things
	#	branch_office_owner = { 
	#		#has_spynetwork = yes 
	#		#any_spynetwork = {
	#		#	owner = { is_same_value = prevprev }
	#		#	is_spynetwork_level > 0
	#		#	target = { is_same_value = root.owner }
	#		#}
	#	}
	#}

	potential = {
		has_branch_office = yes
		branch_office_owner = { is_worker_coop_empire = yes }
		OWNER = { 
			OR = {
				has_policy_flag = slavery_allowed 
				any_owned_pop_group = {
					has_living_standard = { type = living_standard_stratified }
				}
			}
		}
	}

	destroy_trigger = {
		exists = owner
		OWNER = { 
			has_policy_flag = slavery_not_allowed 
			count_owned_pop_amount = {
				limit = {
					has_living_standard = { type = living_standard_stratified }
				}
				count < 1
			}
		}
		#branch_office_owner = { 	#Steam: Another weird set of tags I decided to tag over to clean up
		#	#count_spynetwork = {
		#	#	count = 0
		#	#	limit = { 
		#	#		owner = { is_same_value = ROOT.OWNER }
		#	#		is_spynetwork_level > 0
		#	#	}
		#	#}
		#}
	}
	
	#triggered_planet_modifier = {
	#	potential = {
	#		exists = owner
	#		count_owned_pop_amount = {
	#			count > 500
	#			limit = {
	#				happiness < 0.70
	#				OR = {
	#					has_ethic = ethic_socialism
	#					has_ethic = ethic_fanatic_socialism
	#					is_egalitarian = yes
	#				}
	#			}
	#		}
	#	}
	#	job_miner_add = 500
	#}
	
	triggered_planet_modifier = {
		potential = {
			owner = { has_policy_flag = slavery_allowed }
		}
		job_underground_railroad_conductor_add = 100
	}
	
	triggered_planet_modifier = {
		potential = {
			any_owned_pop_group = {
				has_living_standard = { type = living_standard_stratified }
			}
		}
		job_general_striker_add = 100
	}

	planet_modifier = {
		job_miner_add = 500
		planet_crime_add = 25
		pop_ethic_egalitarian_attraction_mult = 0.125
		pop_ethic_socialism_attraction_mult = 0.125
		branch_office_value_mult = -0.50
	}

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 10
			minerals = 500
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 10
		}
		produces = {
			unity = 6
		}
		upkeep = {
			energy = 5
		}
	}

	ai_weight = {
		weight = 5
	}
}

## REGULAR MEGACORP ##
building_private_mining_consortium = {
	base_buildtime = @b1_time
	planet_limit = 1
	owner_type = corporate

	category = resource

	allow = {
		OR = {
			owner = { has_overlord = prev.branch_office_owner }
			branch_office_owner = {
				OR = {
					has_commercial_pact = prev.OWNER
					is_in_federation_with = prev.OWNER
				}
			}
			custom_tooltip = {
				fail_text = preftl_action_trade_pact
				AND = {
					has_observation_outpost = yes
					observation_outpost = {
						has_modifier = preftl_action_trade_pact
					}
				}
			}
		}
	}


	potential = {
		has_branch_office = yes
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
		}
		is_artificial = no
		NOR = {
			is_planet_class = pc_hive
			is_planet_class = pc_machine
			is_planet_class = pc_city
		}
	}

	planet_modifier = {
		job_miner_add = 200
	}
	
	custom_tooltip = trade_value_from_miners

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|minerals|
	}

	#Trade value from civics
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_privatized_exploration
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|minerals|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_slaver_guilds
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|minerals|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_mining_guilds
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|minerals|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_private_prospectors
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|minerals|
	}

	#Crims cause crime even with deal
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_privatized_exploration
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_slaver_guilds
			}
		}
		job_capital_trader_add = @traders_from_civic
	}


	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_mining_guilds
			}
		}
		job_capital_trader_add = @traders_from_civic
	}


	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_private_prospectors
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 10
			minerals = 500
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 10
		}
		produces = {
			minerals = 10
			mult = value:branch_office_value_for_buildings
		}
		upkeep = {
			energy = 2
		}
	}

	ai_weight = {
		factor = 1
		mult = value:num_jobs_with_tag|TAG|minerals|
	}

	destroy_trigger = {
		exists = owner
		branch_office_owner = { is_illegal_criminal = yes }
	}

	convert_to = {
		building_wildcat_miners
	}
}

building_food_conglomerate = {
	base_buildtime = @b1_time
	planet_limit = 1

	owner_type = corporate

	category = resource

	allow = {
		OR = {
			owner = { has_overlord = prev.branch_office_owner }
			branch_office_owner = {
				OR = {
					has_commercial_pact = prev.OWNER
					is_in_federation_with = prev.OWNER
				}
			}
			custom_tooltip = {
				fail_text = preftl_action_trade_pact
				AND = {
					has_observation_outpost = yes
					observation_outpost = {
						has_modifier = preftl_action_trade_pact
					}
				}
			}
		}
	}

	potential = {

		has_branch_office = yes
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
		}
		NOR = {
			is_planet_class = pc_hive
			is_planet_class = pc_machine
			is_planet_class = pc_relic
		}
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|food|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					has_valid_civic = civic_corporate_machine_anglers
					has_valid_civic = civic_corporate_anglers
				}
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|food|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_permanent_employment
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|food|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_beastmasters
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|food|
	}

	#Crims cause crime even with deal
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					has_valid_civic = civic_corporate_machine_anglers
					has_valid_civic = civic_corporate_anglers
				}
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_permanent_employment
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_beastmasters
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				OR = {
					is_anglers_empire = no
					AND = {
						is_anglers_empire = yes
						PREV = { planet = { is_wet = no } }
					}
				}
			}
		}
		modifier = {
			job_farmer_add = 200
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_anglers_empire = yes
				PREV = { planet = { is_wet = yes } }
			}
		}
		modifier = {
			job_farmer_add = 200
		}
	}

	custom_tooltip = trade_value_from_farmers

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 10
			minerals = 500
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 10
		}
		produces = {
			food = 10
			mult = value:branch_office_value_for_buildings
		}
		upkeep = {
			energy = 2
		}
	}

	destroy_trigger = {
		exists = owner
		branch_office_owner = { is_illegal_criminal = yes }
	}

	convert_to = {
		building_bio_reprocessing_facilities
	}

	ai_weight = {
		factor = 1
	}#AI has many other sources for this resource
}

building_virtual_entertainment_studios = {
	base_buildtime = @b1_time
	planet_limit = 1			 

	owner_type = corporate

	category = manufacturing

	allow = {
		if = {
			limit = { branch_office_owner = { NOT = { is_same_value = prev.owner } } }
			OR = {
				owner = { has_overlord = prev.branch_office_owner }
				branch_office_owner = {
					OR = {
						has_commercial_pact = prev.OWNER
						is_in_federation_with = prev.OWNER
					}
				}
				custom_tooltip = {
					fail_text = preftl_action_trade_pact
					AND = {
						has_observation_outpost = yes
						observation_outpost = {
							has_modifier = preftl_action_trade_pact
						}
					}
				}
			}
		}
	}

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
		}
	}
	
	inline_script = {
		script = jobs/factory_add
		AMOUNT = @b1_jobs
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|consumer_goods|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					has_valid_civic = civic_consumerism
					has_valid_civic = civic_consumerism_corporate
				}
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|consumer_goods|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_crafters
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|consumer_goods|
	}


	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_media_conglomerate
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|consumer_goods|
	}

	#Crims cause crime even with deal
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_crafters
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					has_valid_civic = civic_consumerism
					has_valid_civic = civic_consumerism_corporate
				}
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_media_conglomerate
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	custom_tooltip = trade_value_from_artisans

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 10
			minerals = 500
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 10
		}
		produces = {
			consumer_goods = 6
			mult = value:branch_office_value_for_buildings
		}
		upkeep = {
			energy = 2
		}
	}

	destroy_trigger = {
		exists = owner
		if = {
			limit = { branch_office_owner = { NOT = { is_same_value = prev.owner } } }
			branch_office_owner = { is_illegal_criminal = yes }
		}
		else = { always = no }
	}

	convert_to = {
		building_underground_chemists
	}

	ai_weight = {
		weight = 3
		modifier = {
			factor = 5
			branch_office_owner = {
				has_monthly_income = {
					resource = consumer_goods
					value < 0
				}
			}
		}
		modifier = {
			factor = 0.5
			branch_office_owner = {
				has_monthly_income = {
					resource = consumer_goods
					value >= 10
				}
			}
		}
	}
}

building_private_shipyards = {
	base_buildtime = @b1_time
	planet_limit = 1			 

	owner_type = corporate

	category = manufacturing

	allow = {
		OR = {
			owner = { has_overlord = prev.branch_office_owner }
			branch_office_owner = {
				OR = {
					has_commercial_pact = prev.OWNER
					is_in_federation_with = prev.OWNER
				}
			}
			custom_tooltip = {
				fail_text = preftl_action_trade_pact
				AND = {
					has_observation_outpost = yes
					observation_outpost = {
						has_modifier = preftl_action_trade_pact
					}
				}
			}
		}
	}

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
		}
	}

	inline_script = {
		script = jobs/foundry_add
		AMOUNT = @b1_jobs
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|alloys|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_naval_contractors
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|alloys|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_military_industry
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|alloys|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_war_industry
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|alloys|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_catalytic_processing
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|alloys|
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_naval_contractors
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_military_industry
			}
		}
		job_capital_trader_add = @traders_from_civic
	}


	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_war_industry
			}
		}
		job_capital_trader_add = @traders_from_civic
	}


	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_catalytic_processing
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	#Crims cause crime even with deal
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}

	custom_tooltip = trade_value_from_metallurgists

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 10
			minerals = 500
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 10
		}
		produces = {
			alloys = 3
			mult = value:branch_office_value_for_buildings
		}
		upkeep = {
			energy = 2
		}
	}

	destroy_trigger = {
		exists = owner
		if = { 
			limit = { branch_office_owner = { NOT = { is_same_value = prev.owner } } }
			branch_office_owner = { is_illegal_criminal = yes }
		}
		else = { always = no }
	}

	convert_to = {
		building_wrecking_yards
	}

	ai_weight = {
		weight = 1
	}
}

building_military_contractors = {
	base_buildtime = @b1_time
	planet_limit = 1			 

	owner_type = corporate

	category = army

	allow = {
		OR = {
			owner = { has_overlord = prev.branch_office_owner }
			branch_office_owner = {
				OR = {
					has_commercial_pact = prev.OWNER
					is_in_federation_with = prev.OWNER
				}
			}
			custom_tooltip = {
				fail_text = preftl_action_trade_pact
				AND = {
					has_observation_outpost = yes
					observation_outpost = {
						has_modifier = preftl_action_trade_pact
					}
				}
			}
		}
	}

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
			NOT = { has_valid_civic = civic_crusader_spirit_corporate }
		}
	}

	triggered_country_modifier = {
		potential = {
			always = yes
		}
		country_naval_cap_add = 10
		mult = value:branch_office_value_for_buildings
	}

	planet_modifier = {
		job_soldier_add = 200
		army_starting_experience_add = 100
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|soldier|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_private_military_companies
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|soldier|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_sovereign_guardianship
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|soldier|
	}


	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_defenders_faith
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|soldier|
	}


	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_nationalistic_zeal
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|soldier|
	}


	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_xeno_militarist
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|soldier|
	}


	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_eco_warfare
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|soldier|
	}


	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_warrior_culture
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|soldier|
	}


	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_private_militaries
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|soldier|
	}


	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_crusader_spirit_corporate
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|soldier|
	}


	#Crims cause crime even with deal
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_private_military_companies
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_sovereign_guardianship
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_defenders_faith
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_nationalistic_zeal
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_xeno_militarist
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_eco_warfare
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_warrior_culture
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_private_militaries
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_crusader_spirit_corporate
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	custom_tooltip = trade_value_from_soldiers

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 10
			minerals = 500
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 10
		}
		upkeep = {
			energy = 2
		}
	}

	#destroy_trigger = {
	#	exists = owner
	#	if = { 		#Steam: Honestly a bit too confusing, better off rewritten
	#		limit = { branch_office_owner = { NOT = { is_same_value = prev.owner } } }
	#		branch_office_owner = { is_illegal_criminal = yes }
	#	}
	#	else = { always = no }
	#}
	
	destroy_trigger = {
		exists = owner
		branch_office_owner = {
			OR = {
				is_illegal_criminal = yes
				has_valid_civic = civic_crusader_spirit_corporate
			}
		}
	}

	convert_to = {
		building_pirate_haven
	}

	ai_weight = {
		factor = 10
	}
}

building_industrial_subsidiary = {
	base_buildtime = @b1_time
	planet_limit = 1

	owner_type = corporate

	category = manufacturing
	
	allow = {
		OR = {
			owner = { has_overlord = prev.branch_office_owner }
			branch_office_owner = {
				OR = {
					has_commercial_pact = prev.OWNER
					is_in_federation_with = prev.OWNER
				}
			}
			custom_tooltip = {
				fail_text = preftl_action_trade_pact
				AND = {
					has_observation_outpost = yes
					observation_outpost = {
						has_modifier = preftl_action_trade_pact
					}
				}
			}
		}
	}

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			OR = {
				is_criminal_syndicate = no
				AND = {
					is_criminal_syndicate = yes
					#has_valid_civic = civic_corporate_scavengers
					#has_valid_civic = civic_corporate_relentless_industrialists
					OR = {
						has_ethic = ethic_industrial
						has_ethic = ethic_fanatic_industrial
					}
				}
			}
		}
	}

	inline_script = {
		script = jobs/foundry_add
		AMOUNT = 100
	}

	inline_script = {
		script = jobs/factory_add
		AMOUNT = 100
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_jobs_with_tag|TAG|industry|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_scavengers
			}
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_jobs_with_tag|TAG|industry|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_peaceful_urbanism 
			}
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_jobs_with_tag|TAG|industry|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_land_of_plenty
			}
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_jobs_with_tag|TAG|industry|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_industrial_automation
			}
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_jobs_with_tag|TAG|industry|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_relentless_industrialists
			}
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_jobs_with_tag|TAG|industry|
	}

	#Crims cause crime even with deal
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}

	#Trader Jobs from civics

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_peaceful_urbanism 
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_land_of_plenty
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_industrial_automation
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_scavengers
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_relentless_industrialists
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	custom_tooltip = trade_value_from_industry

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 25
			minerals = 800
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 25
		}
		produces = {
			alloys = 1
			consumer_goods = 1
			mult = value:branch_office_value_for_buildings
		}
		upkeep = {
			energy = 2
		}
	}

	ai_weight = {
		factor = 10
	}
}

building_public_relations_office = {
	base_buildtime = @b2_time
	planet_limit = 1

	owner_type = corporate

	category = unity

	allow = {
		OR = {
			owner = { has_overlord = prev.branch_office_owner }
			branch_office_owner = {
				OR = {
					has_commercial_pact = prev.OWNER
					is_in_federation_with = prev.OWNER
				}
			}
			custom_tooltip = {
				fail_text = preftl_action_trade_pact
				AND = {
					has_observation_outpost = yes
					observation_outpost = {
						has_modifier = preftl_action_trade_pact
					}
				}
			}
		}
	}

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_regular_empire = yes
				is_spiritualist = no
				has_make_spiritualist_perk = no
			}
		}
		job_bureaucrat_add = @b1_jobs
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_megacorp = yes
				is_worker_coop_empire = no
			}
		}
		modifier = {
			job_manager_add = @b1_jobs
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_worker_coop_empire = yes
			}
		}
		modifier = {
			job_steward_add = @b1_jobs
		}
	}

	inline_script = {
		script = jobs/priests_add
		AMOUNT = @b1_jobs
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|unity|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_ascensionists
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|unity|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_chosen_people
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|unity|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_public_relations_specialists
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|unity|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_galactic_curators
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|unity|
	}

	#Crims cause crime even with deal
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_ascensionists
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_chosen_people
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_public_relations_specialists
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_galactic_curators
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	custom_tooltip = trade_value_from_bureaucrats

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 25
			minerals = @b3_minerals
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 25
		}
		produces = {
			unity = 6
			mult = value:branch_office_value_for_buildings
		}
		upkeep = {
			energy = 3
		}
	}

	destroy_trigger = {
		exists = owner
		if = {
			limit = { branch_office_owner = { NOT = { is_same_value = prev.owner } } }
			branch_office_owner = { is_illegal_criminal = yes }
		}
		else = { always = no }
	}

	convert_to = {
		building_syndicate_outreach_office
	}

	ai_weight = {
		weight = 2
	}
}

building_private_research_initiative = {
	base_buildtime = @b2_time
	planet_limit = 1

	owner_type = corporate

	category = research

	allow = {
		OR = {
			owner = { has_overlord = prev.branch_office_owner }
			branch_office_owner = {
				OR = {
					has_commercial_pact = prev.OWNER
					is_in_federation_with = prev.OWNER
				}
			}
			custom_tooltip = {
				fail_text = preftl_action_trade_pact
				AND = {
					has_observation_outpost = yes
					observation_outpost = {
						has_modifier = preftl_action_trade_pact
					}
				}
			}
		}
	}

	potential = {

		has_branch_office = yes
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
		}
	}

	inline_script = {
		script = jobs/researchers_add
		AMOUNT = @building_static_jobs_3
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|research|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_dark_consortium
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|research|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_research_cooperatives
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|research|
	}

	#triggered_planet_modifier = {	#Steam: covered by another modifier
	#	potential = {
	#		branch_office_owner = {
	#			has_valid_civic = civic_astrometeorology
	#		}
	#	}
	#	planet_jobs_trade_produces_mult = @trade_value_from_jobs
	#	mult = value:num_jobs_with_tag|TAG|research|
	#}
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_terraforming
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|research|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_eager_explorers
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|research|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_technocracy 
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|research|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_innovative_economy_corporate
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|research|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_crowdsourcing
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|research|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					has_valid_civic = civic_astrometeorology_megacorp
					has_valid_civic = civic_astrometeorology
				}
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|research|
	}

	#Crims cause crime even with deal
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_dark_consortium
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_research_cooperatives
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	#triggered_country_modifier = {		#Steam: covered by another modifier
	#	potential = {
	#		branch_office_owner = {
	#			has_valid_civic = civic_astrometeorology
	#		}
	#	}
	#	job_capital_trader_add = @traders_from_civic
	#}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_terraforming
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_eager_explorers
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_technocracy
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_innovative_economy_corporate
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_crowdsourcing
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					has_valid_civic = civic_astrometeorology_megacorp
					has_valid_civic = civic_astrometeorology
				}
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	custom_tooltip = trade_value_from_researchers

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 25
			minerals = @b3_minerals
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 25
		}
		produces = {
			physics_research = 5
			engineering_research = 5
			society_research = 5
			mult = value:branch_office_value_for_buildings
		}
		upkeep = {
			energy = 3
		}
	}

	destroy_trigger = {
		exists = owner
		if = { 
			limit = { branch_office_owner = { NOT = { is_same_value = prev.owner } } }
			branch_office_owner = { is_illegal_criminal = yes }
		}
		else = { always = no }
	}

	convert_to = {
		building_illicit_research_labs
	}

	ai_weight = {
		weight = 10
	}
}

building_amusement_megaplex = {
	base_buildtime = @b2_time
	planet_limit = 1

	owner_type = corporate

	category = amenity

	allow = {
		if = {
			limit = { branch_office_owner = { NOT = { is_same_value = prev.owner } } }
			OR = {
				owner = { has_overlord = prev.branch_office_owner }
				branch_office_owner = {
					OR = {
						has_commercial_pact = prev.OWNER
						is_in_federation_with = prev.OWNER
					}
				}
				custom_tooltip = {
					fail_text = preftl_action_trade_pact
					AND = {
						has_observation_outpost = yes
						observation_outpost = {
							has_modifier = preftl_action_trade_pact
						}
					}
				}
			}
		}
	}

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
		}
	}

	planet_modifier = {
		job_entertainer_add = 200
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_pops_in_strata|STRATA|worker|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_hedonism
			}
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_pops_in_strata|STRATA|worker|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					has_valid_civic = civic_consumerism
					has_valid_civic = civic_consumerism_corporate
				}
			}
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_pops_in_strata|STRATA|worker|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_hyperspace_specialty
			}
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_pops_in_strata|STRATA|worker|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_storm_callers_megacorp
			}
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_pops_in_strata|STRATA|worker|
	}

	#Crims cause crime even with deal
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_hedonism
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					has_valid_civic = civic_consumerism
					has_valid_civic = civic_consumerism_corporate
				}
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_hyperspace_specialty
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_storm_callers_megacorp
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	custom_tooltip = trade_value_from_workers

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 25
			minerals = @b3_minerals
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 25
		}
		produces = {
			energy = 10
			mult = value:branch_office_value_for_buildings
		}
	}

	destroy_trigger = {
		exists = owner
		if = { 
			limit = { branch_office_owner = { NOT = { is_same_value = prev.owner } } }
			branch_office_owner = { is_illegal_criminal = yes }
		}
		else = { always = no }
	}

	convert_to = {
		building_underground_clubs
	}

	ai_weight = {
		weight = 2

		modifier = {
			weight = 0.5
			branch_office_owner = {
				has_monthly_income = {
					resource = energy
					value > 50
				}
			}
		}
	}
}

building_commercial_forum = {
	base_buildtime = @b2_time
	planet_limit = 1

	owner_type = corporate

	category = government

	allow = {
		OR = {
			owner = { has_overlord = prev.branch_office_owner }
			branch_office_owner = {
				OR = {
					has_commercial_pact = prev.OWNER
					is_in_federation_with = prev.OWNER
				}
			}
			custom_tooltip = {
				fail_text = preftl_action_trade_pact
				AND = {
					has_observation_outpost = yes
					observation_outpost = {
						has_modifier = preftl_action_trade_pact
					}
				}
			}
		}
	}

	potential = {

		has_branch_office = yes
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
		}
	}

	planet_modifier = {
		#job_merchant_add = 100 #Steam: Not a job anymore
		job_entrepreneur_add = 100
		job_trader_add = 100
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_trading_posts	
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_merchant_guilds
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_dominion
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_state_monopoly
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_in_perfect
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_globalism
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_meritocratic_capitalism
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_franchising
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_memory_vault_corporate
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	#Crims cause crime even with deal
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_trading_posts
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_merchant_guilds
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_dominion
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_state_monopoly
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_in_perfect
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_globalism
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_meritocratic_capitalism
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_franchising
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_memory_vault_corporate
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	custom_tooltip = trade_value_from_traders

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 25
			minerals = @b3_minerals
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 25
		}
		upkeep = {
			energy = 3
		}
	}

	destroy_trigger = {
		exists = owner
		if = { 
			limit = { branch_office_owner = { NOT = { is_same_value = prev.owner } } }
			branch_office_owner = { is_illegal_criminal = yes }
		}
		else = { always = no }
	}

	convert_to = {
		building_smuggling_rings
	}

	ai_weight = {
		weight = 50
	}
}

building_corporate_embassy = {
	base_buildtime = @b2_time
	planet_limit = 1

	owner_type = corporate

	category = government

	allow = {
		OR = {
			owner = { has_overlord = prev.branch_office_owner }
			branch_office_owner = {
				OR = {
					has_commercial_pact = prev.OWNER
					is_in_federation_with = prev.OWNER
				}
			}
			custom_tooltip = {
				fail_text = preftl_action_trade_pact
				AND = {
					has_observation_outpost = yes
					observation_outpost = {
						has_modifier = preftl_action_trade_pact
					}
				}
			}
		}
		has_major_upgraded_capital = yes
	}

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
		}
	}

	allow = {
		has_major_upgraded_capital = yes
	}

	prerequisites = {
		"tech_xeno_diplomacy"
	}

	show_tech_unlock_if = {
		is_megacorp = yes
		is_criminal_syndicate = no
	}

	country_modifier = {
		diplo_weight_economy_mult = 0.05
	}

	planet_modifier = {
		#job_clerk_add = 200 #No more clerks
		job_trader_add = 200
	}

	inline_script = {
		script = "jobs/politician_add"
		AMOUNT = 100
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_brand_loyalty
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_shared_burden
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_xeno_militarist
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_peacekeepers
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_evangelism
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_guided_sapience
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	#Crims cause crime even with deal
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_brand_loyalty
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_shared_burden
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_xeno_militarist
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_peacekeepers
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_evangelism
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_guided_sapience
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	custom_tooltip = trade_value_from_traders

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 25
			minerals = @b3_minerals
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 25
		}
		upkeep = {
			energy = 3
		}
	}

	destroy_trigger = {
		exists = owner
		if = { 
			limit = { branch_office_owner = { NOT = { is_same_value = prev.owner } } }
			branch_office_owner = { is_illegal_criminal = yes }
		}
		else = { always = no }
	}

	convert_to = {
		building_disinformation_center
	}

	ai_weight = {
		weight = 50
		modifier = {
			factor = 10
			branch_office_owner = {
				is_galactic_community_member = yes
			}
		}
	}
}

building_private_security = {
	base_buildtime = @b1_time
	planet_limit = 1

	owner_type = corporate

	category = government

	allow = {
		OR = {
			owner = { has_overlord = prev.branch_office_owner }
			branch_office_owner = {
				OR = {
					has_commercial_pact = prev.OWNER
					is_in_federation_with = prev.OWNER
					is_criminal_syndicate = yes
					has_valid_civic = civic_ruthless_competition
				}
			}
			custom_tooltip = {
				fail_text = preftl_action_trade_pact
				AND = {
					has_observation_outpost = yes
					observation_outpost = {
						has_modifier = preftl_action_trade_pact
					}
				}
			}
		}
	}
	
	potential = {
		has_branch_office = yes
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_legit_or_legal_criminal = yes
			}
		}
		job_enforcer_add = 200
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = { is_illegal_criminal = yes }
		}
		job_criminal_add = 100
		job_enforcer_add = 100
		planet_crime_add = 25 #offsets the enforcer job. >:)
		#mult = branch_office_owner.value:scripted_modifier_mult|MODIFIER|branch_office_holding_crime_mult| #let's not mult criminal jobs.
	}
	
	triggered_planet_modifier = {		# Enriad - commandante_pirate but for holdings
		potential = {					#Steam: Commandante_pirate is now polaticians, offworld version will stay seperate
			exists = owner
			branch_office_owner = {
				has_civic = civic_military_dictatorship_corporate
			}
		}
		modifier = {
			job_commandante_pirate_offworld_add = 50
		}
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|crime| #benefits from enforcers, criminals, slaves, livestock and purged pops
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
				#	value = civic_ruthless_competition			# Due to Slavery -> #'ed for balance reasons. All corporate civics boost different BOBs - Szatan2000
				#	value = civic_slaver_guilds					# Due to Slavery
					has_valid_civic = civic_indentured_assets   # Vanilla
				#	value = civic_barbaric_despoilers			# Due to Slavery
				#	value = civic_barbaric_despoilers_corporate	# Due to Slavery
				#	value = civic_private_militaries			# Private Military Civic
				#   value = civic_private_military_companies	# Private Military Civic
				}
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|crime| #benefits from enforcers, criminals, slaves, livestock and purged pops
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_slave_race
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|crime| #benefits from enforcers, criminals, slaves, livestock and purged pops
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_police_state
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|crime| #benefits from enforcers, criminals, slaves, livestock and purged pops
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_genetic_identification
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|crime| #benefits from enforcers, criminals, slaves, livestock and purged pops
	}

	#Crims cause crime even with deal
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					is_criminal_syndicate = yes
					has_civic = civic_military_dictatorship_corporate
				}
				is_legit_or_legal_criminal = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					#value = civic_ruthless_competition			# Due to Balance
					#value = civic_slaver_guilds					# Due to Slavery
					has_valid_civic = civic_indentured_assets				# Due to Vanilla
					#value = civic_barbaric_despoilers			# Due to Slavery
					#value = civic_barbaric_despoilers_corporate	# Due to Slavery
					#value = civic_private_militaries			# Private Military Civic
					#value = civic_private_military_companies	# Private Military Civic
				}
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_slave_race
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_police_state
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_genetic_identification
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	custom_tooltip = trade_value_from_enforcers_and_criminals

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 10
			minerals = 500
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 10
		}
		produces = {
			energy = 10
			mult = value:branch_office_value_for_buildings
		}
	}

	ai_weight = {
		factor = 10
	}
}


## CRIME MEGACORP ##
building_wildcat_miners = {
	base_buildtime = @b1_time

	owner_type = corporate

	category = government

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			OR = {
				#is_illegal_criminal = yes	#Vanilla
				AND = {
					is_illegal_criminal = yes
					has_civic = civic_criminal_heritage
				}
				has_valid_civic = civic_ruthless_competition
			}
		}
		is_artificial = no
		NOR = {
			is_planet_class = pc_hive
			is_planet_class = pc_machine
			is_planet_class = pc_city
		}
	}

	planet_modifier = {
		#planet_jobs_trade_produces_add = 5
		planet_crime_add = 10
		job_miner_add = 100
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			branch_office_owner = {
				has_valid_civic = civic_ruthless_competition
			}
		}
		pop_ethic_capitalism_attraction_mult = 0.10
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			branch_office_owner = {
				is_criminal_syndicate = yes
			}
		}
		planet_crime_add = 15
		job_criminal_add = 100
		mult = branch_office_owner.value:scripted_modifier_mult|MODIFIER|branch_office_holding_crime_mult|
	}

	custom_tooltip = trade_value_from_miners

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|minerals|
	}

	#Trade value from civics
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_privatized_exploration
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|minerals|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_mining_guilds
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|minerals|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_slaver_guilds
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|minerals|
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_privatized_exploration
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_slaver_guilds
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_mining_guilds
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_private_prospectors
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 20
			minerals = 500
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 20
		}
		produces = {
			minerals = 10
			mult = value:branch_office_value_for_buildings
		}
		upkeep = {
			energy = 2
		}
	}

	destroy_trigger = {
		exists = owner
		if = { 
			limit = { branch_office_owner = { NOT = { is_same_value = prev.owner } } }
			branch_office_owner = {
				is_legit_or_legal_criminal = yes
			}
		}
		else = { always = no }
	}

	convert_to = {
		building_private_mining_consortium
	}

	ai_weight = {
		factor = 1
	}
}

building_bio_reprocessing_facilities = {
	base_buildtime = @b1_time
	planet_limit = 1
		 

	owner_type = corporate

	category = resource

	potential = {
	
		has_branch_office = yes
		branch_office_owner = {
			is_ai = no
			OR = {
				AND = {
					is_illegal_criminal = yes
					has_civic = civic_criminal_heritage
				}
				has_valid_civic = civic_ruthless_competition
			}
		}
		NOR = {
			is_planet_class = pc_hive
			is_planet_class = pc_machine
			is_planet_class = pc_relic
		}
	}

	allow = {
		planet_crime > 50
	}

	destroy_trigger = {
		planet_crime = 0
	}

	planet_modifier = {
		#planet_jobs_trade_produces_add = 5
		job_farmer_add = 100
		job_criminal_add = 100
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			branch_office_owner = {
				has_valid_civic = civic_ruthless_competition
			}
		}
		pop_ethic_socialism_attraction_mult = -0.125
		pop_ethic_egalitarian_attraction_mult = -0.125
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			#branch_office_owner = {
			#	is_criminal_syndicate = yes
			#}
		}
		planet_crime_add = 25
		mult = branch_office_owner.value:scripted_modifier_mult|MODIFIER|branch_office_holding_crime_mult|
	}
	
	custom_tooltip = trade_value_from_farmers
	
	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|food|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_anglers_empire = yes
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|food|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_permanent_employment
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|food|
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				is_anglers_empire = yes
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_permanent_employment
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 20
			minerals = 500
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 20
		}
		produces = {
			food = 10
			mult = value:branch_office_value_for_buildings
		}
		upkeep = {
			energy = 2
		}
	}

	destroy_trigger = {
		exists = owner
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
		}
	}

	convert_to = {
		building_food_conglomerate
	}

	ai_weight = {
		factor = 1
	}
}

building_underground_chemists = {
	base_buildtime = @b1_time

	owner_type = corporate

	category = manufacturing

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			is_illegal_criminal = yes
			has_civic = civic_criminal_heritage
		}
	}

	inline_script = {
		script = jobs/factory_add
		AMOUNT = 100
	}
	
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_private_healthcare_corporate
			}
		}
		job_corrupt_healthcare_add = 100
	}
	
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				NOT = { has_valid_civic = civic_private_healthcare_corporate }
			}
		}
		job_criminal_add = 100
	}

	triggered_planet_modifier = {
		planet_crime_add = 25
		mult = branch_office_owner.value:scripted_modifier_mult|MODIFIER|branch_office_holding_crime_mult|
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|consumer_goods|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_crafters
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|consumer_goods|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_consumerism
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|consumer_goods|
	}


	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_media_conglomerate
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|consumer_goods|
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_crafters
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					has_valid_civic = civic_consumerism
					has_valid_civic = civic_consumerism_corporate
				}
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_media_conglomerate
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	custom_tooltip = trade_value_from_artisans

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 20
			minerals = 500
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 20
		}
		produces = {
			consumer_goods = 6
			mult = value:branch_office_value_for_buildings
		}
		upkeep = {
			energy = 2
		}
	}

	destroy_trigger = {
		exists = owner
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
		}
	}

	convert_to = {
		building_virtual_entertainment_studios
	}

	ai_weight = {
		weight = 3
		modifier = {
			factor = 5
			branch_office_owner = {
				has_monthly_income = {
					resource = consumer_goods
					value < 0
				}
			}
		}
		modifier = {
			factor = 0.5
			branch_office_owner = {
				has_monthly_income = {
					resource = consumer_goods
					value >= 10
				}
			}
		}
	}
}

building_wrecking_yards = {
	base_buildtime = @b1_time

	owner_type = corporate

	category = manufacturing

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			is_ai = no
			OR = {
				AND = {
					is_illegal_criminal = yes
					has_civic = civic_criminal_heritage
				}
				has_valid_civic = civic_ruthless_competition
			}
		}
	}

	planet_modifier = {
		planet_crime_add = 10
		job_corrupt_manager_add = 100
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			branch_office_owner = {
				is_criminal_syndicate = yes
			}
		}
		planet_crime_add = 15
		mult = branch_office_owner.value:scripted_modifier_mult|MODIFIER|branch_office_holding_crime_mult|
	}

	inline_script = {
		script = jobs/foundry_add
		AMOUNT = 100
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|alloys|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_naval_contractors
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|alloys|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_military_industry
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|alloys|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_war_industry
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|alloys|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_catalytic_processing
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|alloys|
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_naval_contractors
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_war_industry
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_military_industry
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_catalytic_processing
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	custom_tooltip = trade_value_from_metallurgists

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 20
			minerals = 500
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 20
		}
		produces = {
			alloys = 3
			mult = value:branch_office_value_for_buildings
		}
		upkeep = {
			energy = 2
		}
	}

	destroy_trigger = {
		exists = owner
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
		}
	}

	convert_to = {
		building_private_shipyards
	}

	ai_weight = {
		factor = 1
	}
}

building_colosseum_branch = {
	base_buildtime = 480

	category = amenity

	owner_type = corporate

	potential = {
		branch_office_owner = { NOT = { is_same_value = prev.owner } }
		has_branch_office = yes
		branch_office_owner = {
			# is_ai = no
			OR = {
				has_valid_civic = civic_slaver_guilds
				has_valid_civic = civic_barbaric_despoilers			# Cog Note - This civic is an upgrade of Slaver Guilds
				has_valid_civic = civic_barbaric_despoilers_corporate	# Cog Note - This civic is an upgrade of Slaver Guilds
				has_valid_civic = civic_divine_order
			}
		}
	}

	allow = {
		OR = {
			owner = { has_overlord = prev.branch_office_owner }
			#has_building = building_slave_processing
			branch_office_owner = {
				OR = {
					has_commercial_pact = prev.OWNER
					is_in_federation_with = prev.OWNER
					is_criminal_syndicate = yes
				}
			}
			custom_tooltip = {
				fail_text = preftl_action_trade_pact
				AND = {
					has_observation_outpost = yes
					observation_outpost = {
						has_modifier = preftl_action_trade_pact
					}
				}
			}
		}
	}
	
	destroy_trigger = {
		exists = owner
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
		}
	}

	planet_modifier = {
		job_gladiator_add = 200
		planet_housing_add = 200
		#planet_jobs_trade_produces_add = 15	#Steam: This adds a flat 15 trade, felt like a gladiator buff fit better
		planet_gladiators_trade_produces_add = 7.5
	}

	army_modifier = {
		army_damage_mult = 0.25
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_civic = civic_warrior_culture	# Cog Note - This makes sense
			}
		}
		modifier = {
			job_gladiator_add = 100	
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|crime| #benefits from enforcers, criminals, slaves, livestock and purged pops
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					has_valid_civic = civic_ruthless_competition			# Due to Slavery
					has_valid_civic = civic_slaver_guilds					# Due to Slavery
					has_valid_civic = civic_indentured_assets				# Due to Slavery
					has_valid_civic = civic_barbaric_despoilers				# Due to Slavery
					has_valid_civic = civic_barbaric_despoilers_corporate	# Due to Slavery
					has_valid_civic = civic_private_militaries				# Private Military Civic
					has_valid_civic = civic_private_military_companies		# Private Military Civic
				}
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|crime| #benefits from enforcers, criminals, slaves, livestock and purged pops
	}
	
	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					has_valid_civic = civic_ruthless_competition			# Due to Slavery
					has_valid_civic = civic_slaver_guilds					# Due to Slavery
					has_valid_civic = civic_indentured_assets				# Due to Slavery
					has_valid_civic = civic_barbaric_despoilers				# Due to Slavery
					has_valid_civic = civic_barbaric_despoilers_corporate	# Due to Slavery
					has_valid_civic = civic_private_militaries				# Private Military Civic
					has_valid_civic = civic_private_military_companies		# Private Military Civic
				}
			}
		}
		job_capital_trader_add = @traders_from_civic
	}
	
	custom_tooltip = trade_value_from_enforcers_and_criminals

	resources = {
		category = planet_branch_office_buildings
		cost = {
			alloys = 20
			minerals = 500
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 20
		}
		upkeep = {
			energy = 10
		}
	}

	triggered_desc = {
		text = job_gladiator_effect_desc
	}

	ai_weight = {
		weight = 1
	}

	on_built = {
		planet = {
			owner = { set_timed_country_flag = { flag = buildings_new_alloys_building months = 16 } }
		}
	}
}

building_pirate_haven = {
	base_buildtime = @b1_time

	owner_type = corporate

	category = army

	allow = {
		OR = {
			owner = { has_overlord = prev.branch_office_owner }
			branch_office_owner = {
				OR = {
					has_commercial_pact = prev.OWNER
					is_in_federation_with = prev.OWNER
					is_criminal_syndicate = yes
					has_valid_civic = civic_ruthless_competition
				}
			}
			custom_tooltip = {
				fail_text = preftl_action_trade_pact
				AND = {
					has_observation_outpost = yes
					observation_outpost = {
						has_modifier = preftl_action_trade_pact
					}
				}
			}
		}
	}
	
	potential = {
		has_branch_office = yes
		branch_office_owner = {
			OR = {
				has_valid_civic = civic_crusader_spirit_corporate
				is_illegal_criminal = yes
			}
		}
	}

	triggered_country_modifier = {
		potential = {
			always = yes
		}
		country_naval_cap_add = 10
		mult = value:branch_office_value_for_buildings
	}

	planet_modifier = {
		planet_crime_add = 10
		job_soldier_add = 100						#Cog Note - Why not have both?
		job_commandante_pirate_offworld_add = 100	#Cog Note - I think we can allow Pirate Captains for everyone
		army_starting_experience_add = 100
		planet_civilians_unity_produces_add = 0.25	#Cog Note - They share stories, don't they? That's unity :P
		planet_civilians_consumer_goods_upkeep_add = 0.125
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			branch_office_owner = {
				is_criminal_syndicate = yes
			}
		}
		planet_crime_add = 15
		job_criminal_add = 100
		mult = branch_office_owner.value:scripted_modifier_mult|MODIFIER|branch_office_holding_crime_mult|
	}

	triggered_planet_modifier = {		# Enriad - commandante_pirate but for holdings
		potential = {
			exists = owner
			owner = {
				has_civic = civic_military_dictatorship_corporate	#Cog Note - This is to check and see if politicians should be added instead
			}
		}
		modifier = {
			job_commandante_pirate_offworld_add = -100
			job_politician_add = 100	#Cog Note - This is on your own planet, so it wouldn't be offworld
		}
	}
	
	#triggered_planet_modifier = {
	#	potential = {
	#		exists = owner
	#		owner = { # Owner of Planet
	#			#has_civic = civic_warrior_culture	# Cog Note - I'm not sure if this makes sense...
	#			OR = {
	#				has_civic = civic_slaver_guilds					# Because gladiators could be pirate thralls
	#				has_civic = civic_barbaric_despoilers			# Because gladiators could be pirate thralls
	#				has_civic = civic_barbaric_despoilers_corporate	# Because gladiators could be pirate thralls
	#			}
	#		}
	#	}
	#	modifier = {
	#		job_gladiator_add = 100	#maybe this is not the building for this job...
	#	}
	#}
	
	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|soldier|
	}
	
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_private_military_companies
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|soldier|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_private_militaries
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|soldier|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_warrior_culture
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|soldier|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_eco_warfare
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|soldier|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_xeno_militarist
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|soldier|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_nationalistic_zeal
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|soldier|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_defenders_faith
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|soldier|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_crusader_spirit_corporate
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|soldier|
	}
	
	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_private_military_companies
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_private_militaries
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_warrior_culture
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_eco_warfare
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_xeno_militarist
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_nationalistic_zeal
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_defenders_faith
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_crusader_spirit_corporate
			}
		}
		job_capital_trader_add = @traders_from_civic
	}
	
	custom_tooltip = trade_value_from_soldiers_and_enforcers_and_criminal

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 20
			minerals = 500
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 20
		}
		upkeep = {
			energy = 10
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					has_valid_civic = civic_ruthless_competition			# Due to Slavery
					has_valid_civic = civic_slaver_guilds					# Due to Slavery
					has_valid_civic = civic_indentured_assets				# Due to Slavery
					has_valid_civic = civic_police_state
					has_valid_civic = civic_slave_race          
					has_valid_civic = civic_barbaric_despoilers				# Due to Slavery
					has_valid_civic = civic_barbaric_despoilers_corporate	# Due to Slavery
					has_valid_civic = civic_private_militaries				# Private Military Civic
					has_valid_civic = civic_private_military_companies		# Private Military Civic
				}
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|crime| #benefits from enforcers, criminals, slaves, livestock and purged pops
	}

	#Crims cause crime even with deal
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					is_criminal_syndicate = yes
					has_civic = civic_military_dictatorship_corporate
				}
				is_legit_or_legal_criminal = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}
	
	destroy_trigger = {
		exists = owner
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
			NOT = { 
				has_valid_civic = civic_crusader_spirit_corporate
			}
		}
	}
	
	convert_to = {
		building_military_contractors
	}

	ai_weight = {
		factor = 1000
	}
}

#Note: No industrial subsidiary-like for crims. They can't get *all* the toys.

building_underground_clubs = {
	base_buildtime = @b2_time
	planet_limit = 1

	owner_type = corporate

	category = amenity

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			is_illegal_criminal = yes
			has_civic = civic_criminal_heritage
		}
	}

	planet_modifier = {
		job_entertainer_add = 100
		job_corrupt_entertainer_add = 100
	}

	triggered_planet_modifier = {
		planet_crime_add = 25
		mult = branch_office_owner.value:scripted_modifier_mult|MODIFIER|branch_office_holding_crime_mult|
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_pops_in_strata|STRATA|worker|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_hedonism
			}
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_pops_in_strata|STRATA|worker|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					has_valid_civic = civic_consumerism
					has_valid_civic = civic_consumerism_corporate
				}
			}
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_pops_in_strata|STRATA|worker|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_hyperspace_specialty
			}
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_pops_in_strata|STRATA|worker|
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_hedonism
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					has_valid_civic = civic_consumerism
					has_valid_civic = civic_consumerism_corporate
				}
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_hyperspace_specialty
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	custom_tooltip = trade_value_from_workers


	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 30
			minerals = @b3_minerals
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 30
		}
		produces = {
			energy = 10
			mult = value:branch_office_value_for_buildings
		}
	}

	destroy_trigger = {
		exists = owner
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
		}
	}

	convert_to = {
		building_amusement_megaplex
		building_knightly_theme_park
	}

	ai_weight = {
		weight = 5

		modifier = {
			factor = 3
			branch_office_owner = {
				has_monthly_income = {
					resource = energy
					value < 0
				}
			}
		}
		modifier = {
			factor = 0.5
			branch_office_owner = {
				has_monthly_income = {
					resource = energy
					value > 50
				}
			}
		}
	}
}

building_syndicate_outreach_office = {
	base_buildtime = @b2_time
	planet_limit = 1

	owner_type = corporate

	category = government

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			is_illegal_criminal = yes
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_megacorp = no
				is_spiritualist = no
				has_make_spiritualist_perk = no
			}
		}
		job_bureaucrat_add = 100
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_megacorp = yes
				is_worker_coop_empire = no
			}
		}
		modifier = {
			job_manager_add = 100
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_worker_coop_empire = yes
			}
		}
		modifier = {
			job_steward_add = 100
		}
	}

	inline_script = {
		script = jobs/priests_add
		AMOUNT = 100
	}

	planet_modifier = {
		job_criminal_add = 100
	}

	triggered_planet_modifier = {
		planet_crime_add = 25
		mult = branch_office_owner.value:scripted_modifier_mult|MODIFIER|branch_office_holding_crime_mult|
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|unity|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_ascensionists
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|unity|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_chosen_people
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|unity|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_public_relations_specialists
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|unity|
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_ascensionists
			}
		}
		job_capital_trader_add = @traders_from_civic
	}
	
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_chosen_people
			}
		}
		job_capital_trader_add = @traders_from_civic
	}
	
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_public_relations_specialists
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	custom_tooltip = trade_value_from_bureaucrats

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 30
			minerals = @b3_minerals
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 30
		}
		produces = {
			unity = 6
			mult = value:branch_office_value_for_buildings
		}
		upkeep = {
			energy = 2
		}
	}

	destroy_trigger = {
		exists = owner
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
		}
	}

	convert_to = {
		building_public_relations_office
	}

	ai_weight = {
		weight = 5
	}
}

building_illicit_research_labs = {
	base_buildtime = @b2_time
	planet_limit = 1

	owner_type = corporate

	category = research

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			is_illegal_criminal = yes
			has_civic = civic_criminal_heritage
		}
	}

	inline_script = {
		script = jobs/researchers_add
		AMOUNT = @scaling_district_3_jobs
	}

	planet_modifier = {
		job_criminal_add = 100
	}

	triggered_planet_modifier = {
		planet_crime_add = 25
		mult = branch_office_owner.value:scripted_modifier_mult|MODIFIER|branch_office_holding_crime_mult|
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|research|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_dark_consortium
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|research|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_research_cooperatives
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|research|
	}
	
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					has_valid_civic = civic_astrometeorology
					has_valid_civic = civic_astrometeorology_megacorp
				}
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|research|
	}
	
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_terraforming
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|research|
	}
	
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_eager_explorers
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|research|
	}
	
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_technocracy
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|research|
	}
	
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_innovative_economy_corporate
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|research|
	}
	
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_memory_vault_corporate
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|research|
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_dark_consortium
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_technocracy
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_innovative_economy_corporate
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_eager_explorers
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_terraforming
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					has_valid_civic = civic_astrometeorology
					has_valid_civic = civic_astrometeorology_megacorp
				}
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_research_cooperatives
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_memory_vault_corporate
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	custom_tooltip = trade_value_from_researchers

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 30
			minerals = @b3_minerals
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 30
		}
		produces = {
			physics_research = 5
			engineering_research = 5
			society_research = 5
			mult = value:branch_office_value_for_buildings
		}
		upkeep = {
			energy = 3
		}
	}

	destroy_trigger = {
		exists = owner
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
		}
	}

	convert_to = {
		building_private_research_initiative
	}

	ai_weight = {
		weight = 10

	}
}

building_smuggling_rings = {
	base_buildtime = @b2_time
	planet_limit = 1

	owner_type = corporate

	category = government

	potential = {
		has_branch_office = yes
		branch_office_owner = { is_criminal_syndicate = yes }
	}

	planet_modifier = {
		#branch_office_value_mult = 0.25
		#job_merchant_add = 100
		job_trader_add = 100
		job_criminal_add = 100
	}

	triggered_planet_modifier = {		# Enriad - commandante_pirate but for holdings
		potential = {
			exists = owner
			branch_office_owner = {
				has_civic = civic_military_dictatorship_corporate
			}
		}
		modifier = {
			job_commandante_pirate_offworld_add = 50
		}
	}

	triggered_planet_modifier = {
		planet_crime_add = 25
		mult = branch_office_owner.value:scripted_modifier_mult|MODIFIER|branch_office_holding_crime_mult|
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_trading_posts
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_meritocratic_capitalism
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_globalism
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_in_perfect
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_state_monopoly
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_dominion
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_merchant_guilds
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_franchising
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_trading_posts
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_meritocratic_capitalism
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_globalism
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_in_perfect
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_state_monopoly
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_dominion
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_merchant_guilds
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_franchising
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	custom_tooltip = trade_value_from_traders

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 30
			minerals = @b3_minerals
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 30
		}
		upkeep = {
			energy = 3
		}
	}

	destroy_trigger = {
		exists = owner
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
		}
	}

	convert_to = {
		building_commercial_forum
	}

	ai_weight = {
		weight = 100
	}
}

building_disinformation_center = {
	base_buildtime = @b2_time
	planet_limit = 1

	owner_type = corporate

	category = government

	potential = {
		owner = { is_megacorp = no }
		has_branch_office = yes
		branch_office_owner = {
			OR = {
				AND = {
					is_illegal_criminal = yes
					has_civic = civic_criminal_heritage
				}
				has_valid_civic = civic_ruthless_competition
				is_worker_coop_empire = yes
			}
		}
	}

	allow = {
		has_major_upgraded_capital = yes
	}

	prerequisites = {
		"tech_xeno_diplomacy"
	}

	show_tech_unlock_if = {
		is_megacorp = yes
		OR = {
			is_illegal_criminal = yes
			has_valid_civic = civic_ruthless_competition
		}
	}

	country_modifier = {
		spy_network_levels_add = 5
	}

	planet_modifier = {
		pop_government_ethic_attraction = -0.25
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			branch_office_owner = {
				has_valid_civic = civic_ruthless_competition
			}
		}
		planet_crime_add = 10
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			branch_office_owner = {
				is_criminal_syndicate = yes
			}
		}
		planet_crime_add = 25
		mult = branch_office_owner.value:scripted_modifier_mult|MODIFIER|branch_office_holding_crime_mult|
	}
	
	inline_script = {
		script = "jobs/politician_add"
		AMOUNT = 100
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
						has_valid_civic = civic_brand_loyalty
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
						has_valid_civic = civic_evangelism
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
						has_valid_civic = civic_peacekeepers
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
					has_valid_civic = civic_xeno_militarist
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
					OR = {
						has_valid_civic = civic_shared_burden
					}
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_guided_sapience
			}
		}
		planet_jobs_trade_produces_mult = 0.02
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
					OR = {
						has_valid_civic = civic_brand_loyalty
					}
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_evangelism
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_shared_burden
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_xeno_militarist
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_peacekeepers
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_guided_sapience
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	custom_tooltip = trade_value_from_traders

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 30
			minerals = @b3_minerals
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 30
		}
		upkeep = {
			energy = 3
		}
	}

	destroy_trigger = {
		exists = owner
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
		}
	}

	convert_to = {
		building_corporate_embassy
	}

	ai_weight = {
		weight = 50
	}
}

building_subversive_shrine = {
	base_buildtime = @b1_time
	planet_limit = 1
	owner_type = corporate

	category = unity

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			has_valid_civic = civic_gospel_of_the_masses
			OR = {
				AND = {
					is_illegal_criminal = yes
					has_civic = civic_criminal_heritage
				}
				has_valid_civic = civic_ruthless_competition
			}
		}
	}
	planet_modifier = {
		job_bureaucrat_add = 200				# Enriad - Preachers are bureaucrats in 4.0
		pop_ethic_spiritualist_attraction_mult = 0.05
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			branch_office_owner = {
				has_valid_civic = civic_ruthless_competition
			}
		}
		planet_crime_add = 25
		mult = branch_office_owner.value:scripted_modifier_mult|MODIFIER|branch_office_holding_crime_mult|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_councilor = { COUNCILOR = "councilor_gospel_of_the_masses" }
			}
		}
		pop_ethics_shift_speed_mult = 0.05
		mult = value:councilor_level|TYPE|councilor_gospel_of_the_masses|
	}

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 30
			minerals = 500
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 30
		}
		upkeep = {
			energy = 2
		}
	}
	ai_weight = {
		weight = 250
	}
}

## GOSPEL MEGACORP ##

building_temple_of_prosperity = {
	base_buildtime = @b1_time
	planet_limit = 1

	owner_type = corporate

	category = unity

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			OR = {
				has_valid_civic = civic_gospel_of_the_masses
				has_valid_civic = civic_exalted_priesthood
				has_valid_civic = civic_spiritual_seekers
				has_valid_civic = civic_evangelism
				has_valid_civic = civic_defenders_faith
			}
			is_legit_or_legal_criminal = yes
		}
	}

	triggered_planet_modifier = {  
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_gospel_of_the_masses
				has_valid_civic = civic_exalted_priesthood
				has_valid_civic = civic_spiritual_seekers
				has_valid_civic = civic_evangelism
				has_valid_civic = civic_defenders_faith
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|amenities|
	}

	triggered_country_modifier = { 
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_gospel_of_the_masses
				has_valid_civic = civic_exalted_priesthood
				has_valid_civic = civic_spiritual_seekers
				has_valid_civic = civic_evangelism
				has_valid_civic = civic_defenders_faith
			}
		}
		job_capital_bureaucrat_add = 100
		job_capital_trader_add = 100
	}

	planet_modifier = {
		job_bureaucrat_add = 200		# Enriad - Preachers are bureaucrats in 4.0
		pop_ethic_spiritualist_attraction_mult = 0.10
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_councilor = { COUNCILOR = "councilor_gospel_of_the_masses" }
			}
		}
		pop_ethics_shift_speed_mult = 0.10
		mult = value:branch_office_councilor_level|TYPE|councilor_gospel_of_the_masses|
	}

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 10
			minerals = 500
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 10
		}
		produces = {
			unity = 6
			mult = value:branch_office_value_for_buildings
		}
		upkeep = {
			energy = 2
		}
	}

	ai_weight = {
		weight = 250
	}
}

## SPECIAL ##

building_executive_retreat = {
	base_buildtime = @b3_time
	planet_limit = 1

	owner_type = corporate

	category = amenity

	prerequisites = { "tech_executive_retreat" }

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
		}
	}

	allow = {
		if = {
			limit = { branch_office_owner = { NOT = { is_same_value = prev.owner } } }
			OR = {
				owner = { has_overlord = prev.branch_office_owner }
				branch_office_owner = {
					OR = {
						has_commercial_pact = prev.OWNER
						is_in_federation_with = prev.OWNER
					}
				}
				custom_tooltip = {
					fail_text = preftl_action_trade_pact
					AND = {
						has_observation_outpost = yes
						observation_outpost = {
							has_modifier = preftl_action_trade_pact
						}
					}
				}
			}
		}
		pop_amount >= 2500
	}

	country_modifier = {
		planet_amenities_mult = 0.1
	}

	planet_modifier = {
		job_entertainer_add = 200
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|amenities|
	}

	triggered_planet_modifier = {  
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_merchant_guilds
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|amenities|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_state_monopoly
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|amenities|
	}

	triggered_planet_modifier = {  
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_genetic_aristocracy	
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|amenities|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_aristocratic_elite
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|amenities|
	}

	triggered_planet_modifier = {  
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_shadow_council
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|amenities|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_ruthless_competition
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|amenities|
	}

	triggered_planet_modifier = {  
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_task_delegation_corporate
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|amenities|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_environmental_architects_megacorp
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_jobs_with_tag|TAG|amenities|
	}

	#Crims cause crime even with deal
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}

	#Trader Jobs from civics

	triggered_country_modifier = { 
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_ruthless_competition
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_shadow_council
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = { 
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_aristocratic_elite_corporate
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_genetic_aristocracy	
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = { 
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_state_monopoly
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_merchant_guilds
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = { 
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_task_delegation_corporate
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_environmental_architects_megacorp
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	custom_tooltip = trade_value_from_entertainers

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 25
			minerals = 1000
			exotic_gases = @b2_rare_cost
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 25
		}
		upkeep = {
			energy = @b2_upkeep
			exotic_gases = @b2_rare_upkeep
		}
	}

	ai_weight = {
		factor = 100
	}
}

building_xeno_tourism_agency = {
	base_buildtime = @b3_time
	planet_limit = 1

	owner_type = corporate

	category = government

	prerequisites = { "tech_xeno_tourism_agency" }

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
		}										
	}

	allow = {
		if = {
			limit = { branch_office_owner = { NOT = { is_same_value = prev.owner } } }
			OR = {
				owner = { has_overlord = prev.branch_office_owner }
				branch_office_owner = {
					OR = {
						has_commercial_pact = prev.OWNER
						is_in_federation_with = prev.OWNER
					}
				}
				custom_tooltip = {
					fail_text = preftl_action_trade_pact
					AND = {
						has_observation_outpost = yes
						observation_outpost = {
							has_modifier = preftl_action_trade_pact
						}
					}
				}
			}
		}
		pop_amount >= 2500
	}

	country_modifier = {
		planet_resettlement_unemployed_destination_mult = 0.25
	}

	planet_modifier = {
		job_entertainer_add = 100
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_pops_in_strata|STRATA|worker|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_civic = civic_worker_coop
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_pops_in_strata|STRATA|worker|
	}

	triggered_planet_modifier = { 
		potential = {
			branch_office_owner = {
				has_civic = civic_meritocracy
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_pops_in_strata|STRATA|worker|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_civic = civic_welfare_state
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_pops_in_strata|STRATA|worker|
	}
	triggered_planet_modifier = { 
		potential = {
			branch_office_owner = {
				has_civic = civic_corporate_dimensional_worship
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_pops_in_strata|STRATA|worker|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_civic = civic_death_cult_corporate
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_pops_in_strata|STRATA|worker|
	}
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_civic = civic_star_settlers
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_pops_in_strata|STRATA|worker|
	}
	triggered_planet_modifier = { 
		potential = {
			branch_office_owner = {
				has_civic = civic_free_haven
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_pops_in_strata|STRATA|worker|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_civic = civic_symbiotic_race
			}
		}
		planet_jobs_trade_produces_mult = @trade_value_from_jobs
		mult = value:num_pops_in_strata|STRATA|worker|
	}
	
	#Crims cause crime even with deal
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_worker_coop
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_dimensional_worship
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_death_cult_corporate
			}
		}
		job_capital_trader_add = @traders_from_civic
	}
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_welfare_state
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_meritocracy
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_star_settlers
			}
		}
		job_capital_trader_add = @traders_from_civic
	}
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_free_haven
			}
		}
		job_capital_trader_add = @traders_from_civic
	}
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_symbiotic_race
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	custom_tooltip = trade_value_from_workers_double

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 25
			minerals = 1000
			rare_crystals = @b2_rare_cost
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 25
		}
		upkeep = {
			energy = @b2_upkeep
			rare_crystals = @b2_rare_upkeep
		}
	}

	ai_weight = {
		weight = 100
	}
}

building_imperial_concession_port = {
	base_buildtime = @b3_time
	planet_limit = 1

	owner_type = corporate

	category = government

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			OR = {
				has_modifier = imperial_charter
				has_civic = civic_galactic_sovereign_megacorp
			}
		}
	}

	country_modifier = {
		diplo_weight_economy_mult = 0.05
	}

	inline_script = {
		script = "jobs/politician_add"
		AMOUNT = 100
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = 0.05
		mult = value:num_pops_in_strata|STRATA|ruler|
	}

	#Crims cause crime even with deal
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}

	custom_tooltip = trade_value_from_rulers

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 25
			minerals = 1000
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 25
		}
		produces = {
			energy = 8
		}
		produces = {
			trade = 20
		}
	}

	ai_weight = {
		weight = 100
	}
}

## TOXIC KNIGHTS ##

building_knightly_theme_park = {
	base_buildtime = @b2_time
	icon = building_order_holding
	planet_limit = 1

	owner_type = corporate

	category = amenity

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			has_origin = origin_toxic_knights
			NOT = { has_country_flag = quest_abandoned }
		}
	}

	allow = {
		if = {
			limit = { branch_office_owner = { NOT = { is_same_value = prev.owner } } }
			OR = {
				owner = { has_overlord = prev.branch_office_owner }
				branch_office_owner = {
					OR = {
						has_commercial_pact = prev.OWNER
						is_in_federation_with = prev.OWNER
					}
				}
				custom_tooltip = {
					fail_text = preftl_action_trade_pact
					AND = {
						has_observation_outpost = yes
						observation_outpost = {
							has_modifier = preftl_action_trade_pact
						}
					}
				}
			}
		}
		pop_amount >= 5000
	}

	planet_modifier = {
		job_entertainer_add = 200
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_pops_in_strata|STRATA|worker|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_civic = civic_corporate_hedonism
			}
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_pops_in_strata|STRATA|worker|
	}
	
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					has_valid_civic = civic_consumerism
					has_valid_civic = civic_consumerism_corporate
				}
			}
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_pops_in_strata|STRATA|worker|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_civic = civic_corporate_hyperspace_specialty
			}
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_pops_in_strata|STRATA|worker|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
				is_legit_or_legal_criminal = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_hedonism
			}
		}
		job_capital_trader_add = @traders_from_civic
	}
	
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					has_valid_civic = civic_consumerism
					has_valid_civic = civic_consumerism_corporate
				}
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_hyperspace_specialty
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	custom_tooltip = trade_value_from_workers

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 25
			minerals = @b3_minerals
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 25
		}
		produces = {
			energy = 10
			mult = value:branch_office_value_for_buildings
		}
	}

	#triggered_desc = {
	#	trigger = {
	#		exists = planet.owner
	#	}
	#	text = knightly_theme_park_quest_effect_desc
	#}

	ai_weight = {
		weight = 5
	}
}

## Pharmaceutical Companies ##
building_corporate_clinics = {
	base_buildtime = @b2_time
	icon = building_corporate_clinic
	planet_limit = 1

	owner_type = corporate

	category = resource

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			OR = {
				has_valid_civic = civic_private_healthcare_corporate
				has_valid_civic = civic_corporate_toxic_baths
				has_valid_civic = civic_corporate_toxic_baths_individual_machine
				has_valid_civic = civic_natural_design
			}
		}
	}

	on_built = {
		planet = {
			set_planet_flag = has_private_clinics
		}
	}

	on_destroy = {
		planet = {
			remove_planet_flag = has_private_clinics
		}
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
				NOT = { is_legit_or_legal_criminal = yes }
			}
		}
		job_corrupt_healthcare_add = 200
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
				is_legit_or_legal_criminal = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}

	planet_modifier = {
		job_healthcare_amenities_add = 100	# see output/healthcare_triggered_modifiers
		planet_doctors_trade_produces_add = 2
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					is_criminal_syndicate = no
					AND = {
						is_criminal_syndicate = yes
						is_legit_or_legal_criminal = yes
					}
				}
			}
		}
		job_healthcare_add = 200
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_pops_in_strata|STRATA|specialist|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				AND = {
					has_valid_civic = civic_private_healthcare_corporate
					OR = {
						has_valid_civic = civic_corporate_toxic_baths
						has_valid_civic = civic_corporate_toxic_baths_individual_machine
						has_valid_civic = civic_natural_design
					}
				}
			}
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_pops_in_strata|STRATA|specialist|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_natural_design
			}
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_pops_in_strata|STRATA|specialist|
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_private_healthcare_corporate
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_natural_design
			}
		}
		job_capital_trader_add = @traders_from_civic
	}
	
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					has_valid_civic = civic_corporate_toxic_baths
					has_valid_civic = 	civic_corporate_toxic_baths_individual_machine
				}
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	custom_tooltip = trade_value_from_specialists

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 25
			minerals = @b3_minerals
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 25
		}
		produces = {
			energy = 8
			unity = 2
			mult = value:branch_office_value_for_buildings
		}
		upkeep = {
			consumer_goods = 1
		}
	}

	#triggered_desc = {
	#	trigger = {
	#		exists = planet.owner
	#	}
	#	text = building_corporate_clinics_effect
	#}

	#triggered_desc = {
	#	text = job_healthcare_effect_desc
	#}
	ai_weight = {
		weight = 120
	}
}

###########################
# Augmentation Bazaars	#
###########################

building_augmentation_bazaars_branch = {
	base_buildtime = @b2_time
	icon = building_corporate_augmentation_bazaars
	planet_limit = 1

	category = trade

	owner_type = corporate

	potential = {
		has_branch_office = yes
		branch_office_owner = { has_valid_civic = civic_augmentation_bazaars }
	}

	allow = {
		OR = {
			owner = { has_overlord = prev.branch_office_owner }
			branch_office_owner = {
				OR = {
					has_commercial_pact = prev.OWNER
					is_in_federation_with = prev.OWNER
				}
			}
			custom_tooltip = {
				fail_text = preftl_action_trade_pact
				AND = {
					has_observation_outpost = yes
					observation_outpost = {
						has_modifier = preftl_action_trade_pact
					}
				}
			}
		}
		# always = yes
	}
	
	destroy_trigger = {
		exists = owner
		OR = {
			owner = { is_regular_empire = no }
			has_modifier = slave_colony
			has_modifier = resort_colony
		}
	}


	triggered_planet_modifier = {
		planet_jobs_trade_produces_mult = 0.10
		job_augmentor_add = 100
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				OR = {
					is_criminal_syndicate = no
					AND = {
						is_criminal_syndicate = yes
						is_legit_or_legal_criminal = yes
					}
				}
			}
		}
		job_augmentor_add = 100
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
				NOT = { is_legit_or_legal_criminal = yes }
			}
		}
		job_criminal_add = 100
	}

	triggered_planet_modifier = {
		potential = {
			exists = branch_office_owner
			branch_office_owner = {
				is_criminal_syndicate = yes
				NOT = { is_legit_or_legal_criminal = yes }
			}
		}
		planet_crime_add = 25
		mult = branch_office_owner.value:scripted_modifier_mult|MODIFIER|branch_office_holding_crime_mult|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
				is_legit_or_legal_criminal = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_pops_in_strata|STRATA|specialist|
	}

	custom_tooltip = trade_value_from_specialists

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_tradition = tr_cybernetics_integrated_anatomy
			}
			any_owned_pop_group = {
				has_auto_modding_trait = yes
			}
		}
		modifier = {
			auto_mod_monthly_add = 100
		}
	}

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 25
			minerals = @b2_minerals
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 25
		}
		upkeep = {
			energy = @b2_upkeep
		}
		produces = {
			engineering_research = 10
			mult = value:branch_office_value_for_buildings
		}
	}

	prerequisites = {}

	#triggered_desc = {
	#	trigger = {
	#		exists = owner
	#		owner = {
	#			is_gestalt = no
	#		}
	#		is_cyborg_empire = yes
	#	}
	#	text = job_augmentor_growth_effect_desc
	#}

	#triggered_desc = {
	#	trigger = {
	#		OR = {
	#			is_scope_valid = no
	#			AND = {
	#				exists = owner
	#				owner = {
	#					is_gestalt = no
	#				}
	#				is_cyborg_empire = no
	#			}
	#		}
	#	}
	#	text = job_augmentor_research_effect_desc
	#}

	ai_resource_production = {
		energy = 5
		trigger = {
			solar_system = {
				#has_system_trade_value >= 50
			}
		}
	}

	ai_resource_production = {
		energy = 3
		trigger = {
			solar_system = {
				#has_system_trade_value >= 80
			}
		}
	}
}

# Synth MegaCorp Physical Branch Office Building
building_ai_emporium = {
	base_buildtime = @b2_time
	planet_limit = 1

	owner_type = corporate

	category = resource

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			is_synth_corporate = yes
			has_country_flag = synth_physical
		}
	}

	allow = {
		custom_tooltip = {
			fail_text = building_ai_emporium_fail_tt
			planet.owner = {
				NOT = {
					any_owned_planet = {
						has_branch_office = yes
						has_holding = {
							holding = building_ai_emporium
							owner = root.branch_office_owner
						}
					}
				}
			}
		}
		custom_tooltip = {
			fail_text = building_ai_emporium_outlawed_robots_tt
			planet.owner = {
				NOT = { has_policy_flag = robots_outlawed }
			}
		}
	}

	planet_modifier = {
		job_roboticist_branch_office_value_mult = 0.10
		job_roboticist_add = 100
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = { is_criminal_syndicate = yes }
		}
		planet_crime_add = 25
		mult = branch_office_owner.value:scripted_modifier_mult|MODIFIER|branch_office_holding_crime_mult|
	}

	#Crims cause crime even with deal
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}

	on_built = {
		planet.owner = {
			create_built_robot_species = yes
		}
	}

	resources = {
		category = planet_branch_office_buildings
		cost = {
			minerals = @b3_minerals
		}
		produces = {
			energy = 10
			physics_research = 10
			mult = value:branch_office_value_for_buildings
		}
	}

	ai_weight = {
		weight = 2

		modifier = {
			weight = 0.5
			branch_office_owner = {
				has_monthly_income = {
					resource = energy
					value > 50
				}
			}
		}
	}
}

# Synth MegaCorp Virtual Branch Office Building
building_clear_thought_clinic = {
	base_buildtime = @b2_time
	planet_limit = 1

	owner_type = corporate

	category = resource

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			is_synth_corporate = yes
			has_country_flag = synth_virtual
		}
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = { is_criminal_syndicate = yes }
		}
		planet_crime_add = 25
		mult = branch_office_owner.value:scripted_modifier_mult|MODIFIER|branch_office_holding_crime_mult|
	}

	#Crims cause crime even with deal
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}

	planet_modifier = {
		planet_jobs_trade_produces_mult = 0.10
		pop_happiness = -0.05
		job_trader_add = 200
	}

	resources = {
		category = planet_branch_office_buildings
		cost = {
			minerals = @b3_minerals
		}
		produces = {
			energy = 10
			society_research = 10
			mult = value:branch_office_value_for_buildings
		}
	}

	on_built = {
		planet.owner = {
			save_event_target_as = planet_owner
		}
		branch_office_owner = {
			save_event_target_as = branch_office_owner
			random_spynetwork = {
				limit = {
					owner = {
						is_same_value = event_target:branch_office_owner
					}
					target = {
						is_same_value = event_target:planet_owner
					}
				}
				add_modifier = {
					modifier = clear_thought_clinic_modifier
					days = -1
				}
			}
		}
	}

	on_destroy = {
		planet = {
			save_event_target_as = planet
		}
		planet.owner = {
			save_event_target_as = planet_owner
		}
		branch_office_owner = {
			save_event_target_as = branch_office_owner
		}
		if = {
			limit = {
				event_target:planet_owner = {
					any_owned_planet = {
						NOT = {
							is_same_value = event_target:planet
						}
						has_branch_office = yes
						branch_office_owner = {
							is_same_value = event_target:branch_office_owner
						}
						has_holding = {
							holding = building_clear_thought_clinic
							owner = event_target:branch_office_owner
						}
					}
				}
			}
			# Do nothing
		}
		else = {
			event_target:branch_office_owner = {
				random_spynetwork = {
					limit = {
						owner = {
							is_same_value = event_target:branch_office_owner
						}
						target = {
							is_same_value = event_target:planet_owner
						}
					}
					remove_modifier = clear_thought_clinic_modifier
				}
			}
		}
	}

	#triggered_desc = {
	#	text = clear_thought_clinic_tt
	#}

	ai_weight = {
		weight = 2

		modifier = {
			weight = 0.5
			branch_office_owner = {
				has_monthly_income = {
					resource = energy
					value > 50
				}
			}
		}
	}
}
